'use strict';

var request = require('request-promise');
var _ = require('lodash');
var Promise = require('bluebird');

var clientId = 'a341a43346c746aeb3b0305a17c95d28';
var clientSecret = '7274cdccf1cc4b47bcead24ff3322820';

var authString = new Buffer(clientId + ':' + clientSecret).toString('base64');

function getToken() {
  return request({
    url: 'https://accounts.spotify.com/api/token',
    method: 'POST',
    headers: {
      Authorization: 'Basic ' + authString
    },
    form: {
      grant_type: 'client_credentials'
    } }).then(function (res) {
    return JSON.parse(res).access_token;
  });
}

var callSpotify = function callSpotify(url, token) {
  if (_.isString(url)) {
    url = { url: url };
  }
  return request(_.merge({
    headers: {
      Authorization: 'Bearer ' + token
    }
  }, url));
};

module.exports = {
  callSpotify: callSpotify,
  getToken: getToken
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hdXRoLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSSxVQUFVLFFBQVEsaUJBQVIsQ0FBZDtBQUNBLElBQUksSUFBSSxRQUFRLFFBQVIsQ0FBUjtBQUNBLElBQUksVUFBVSxRQUFRLFVBQVIsQ0FBZDs7QUFFQSxJQUFJLFdBQVcsa0NBQWY7QUFDQSxJQUFJLGVBQWUsa0NBQW5COztBQUVBLElBQUksYUFBYSxJQUFJLE1BQUosQ0FBVyxXQUFXLEdBQVgsR0FBaUIsWUFBNUIsRUFBMEMsUUFBMUMsQ0FBbUQsUUFBbkQsQ0FBakI7O0FBRUEsU0FBUyxRQUFULEdBQXFCO0FBQ25CLFNBQU8sUUFBUTtBQUNiLFNBQUssd0NBRFE7QUFFYixZQUFRLE1BRks7QUFHYixhQUFTO0FBQ1AscUJBQWUsV0FBVztBQURuQixLQUhJO0FBTWIsVUFBTTtBQUNKLGtCQUFZO0FBRFIsS0FOTyxFQUFSLEVBU0osSUFUSSxDQVNDO0FBQUEsV0FBTyxLQUFLLEtBQUwsQ0FBVyxHQUFYLEVBQWdCLFlBQXZCO0FBQUEsR0FURCxDQUFQO0FBVUQ7O0FBRUQsSUFBSSxjQUFjLFNBQWQsV0FBYyxDQUFVLEdBQVYsRUFBZSxLQUFmLEVBQXNCO0FBQ3RDLE1BQUksRUFBRSxRQUFGLENBQVcsR0FBWCxDQUFKLEVBQXFCO0FBQ25CLFVBQU0sRUFBRSxLQUFLLEdBQVAsRUFBTjtBQUNEO0FBQ0QsU0FBTyxRQUFRLEVBQUUsS0FBRixDQUFRO0FBQ3JCLGFBQVM7QUFDUCxxQkFBZSxZQUFZO0FBRHBCO0FBRFksR0FBUixFQUlaLEdBSlksQ0FBUixDQUFQO0FBS0QsQ0FURDs7QUFXQSxPQUFPLE9BQVAsR0FBaUI7QUFDZixlQUFhLFdBREU7QUFFZixZQUFVO0FBRkssQ0FBakIiLCJmaWxlIjoiYXV0aC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciByZXF1ZXN0ID0gcmVxdWlyZSgncmVxdWVzdC1wcm9taXNlJyk7XG52YXIgXyA9IHJlcXVpcmUoJ2xvZGFzaCcpO1xudmFyIFByb21pc2UgPSByZXF1aXJlKCdibHVlYmlyZCcpO1xuXG52YXIgY2xpZW50SWQgPSAnYTM0MWE0MzM0NmM3NDZhZWIzYjAzMDVhMTdjOTVkMjgnO1xudmFyIGNsaWVudFNlY3JldCA9ICc3Mjc0Y2RjY2YxY2M0YjQ3YmNlYWQyNGZmMzMyMjgyMCc7XG5cbnZhciBhdXRoU3RyaW5nID0gbmV3IEJ1ZmZlcihjbGllbnRJZCArICc6JyArIGNsaWVudFNlY3JldCkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuXG5mdW5jdGlvbiBnZXRUb2tlbiAoKSB7XG4gIHJldHVybiByZXF1ZXN0KHtcbiAgICB1cmw6ICdodHRwczovL2FjY291bnRzLnNwb3RpZnkuY29tL2FwaS90b2tlbicsXG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgaGVhZGVyczoge1xuICAgICAgQXV0aG9yaXphdGlvbjogJ0Jhc2ljICcgKyBhdXRoU3RyaW5nXG4gICAgfSxcbiAgICBmb3JtOiB7XG4gICAgICBncmFudF90eXBlOiAnY2xpZW50X2NyZWRlbnRpYWxzJ1xuICAgIH19KVxuICAgIC50aGVuKHJlcyA9PiBKU09OLnBhcnNlKHJlcykuYWNjZXNzX3Rva2VuKVxufVxuXG52YXIgY2FsbFNwb3RpZnkgPSBmdW5jdGlvbiAodXJsLCB0b2tlbikge1xuICBpZiAoXy5pc1N0cmluZyh1cmwpKSB7XG4gICAgdXJsID0geyB1cmw6IHVybCB9O1xuICB9XG4gIHJldHVybiByZXF1ZXN0KF8ubWVyZ2Uoe1xuICAgIGhlYWRlcnM6IHtcbiAgICAgIEF1dGhvcml6YXRpb246ICdCZWFyZXIgJyArIHRva2VuXG4gICAgfVxuICB9LCB1cmwpKVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgY2FsbFNwb3RpZnk6IGNhbGxTcG90aWZ5LFxuICBnZXRUb2tlbjogZ2V0VG9rZW5cbn1cbiJdfQ==