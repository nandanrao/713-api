'use strict';

// app.js
var express = require('express');
var bodyParser = require('body-parser');
var tokenMiddleware = require('./token');

var mood = require('./mood');
var app = express();
app.use(bodyParser.urlencoded({ extended: false }));
app.use(bodyParser.json());

app.use(tokenMiddleware());

app.post('/mood', function (req, res, next) {
  console.log(req.user); // songId
  mood.handler(req.body, req.user.id).then(function (ans) {
    res.status(200).send(ans);
  });
  // next
});

app.get('partyinfo', function (req, res, next) {
  var info = {
    startTime: 1463263723300,
    location: 'Cool Park'
  };
  res.json(info);
});

app.use(function (err, req, res, next) {
  console.log('err', err.statusCode || err);
  res.status(err.statusCode || err).send();
});

app.listen(process.env.PORT || 9000);

module.exports = app;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hcHAuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQ0EsSUFBSSxVQUFVLFFBQVEsU0FBUixDQUFkO0FBQ0EsSUFBSSxhQUFhLFFBQVEsYUFBUixDQUFqQjtBQUNBLElBQUksa0JBQWtCLFFBQVEsU0FBUixDQUF0Qjs7QUFFQSxJQUFJLE9BQU8sUUFBUSxRQUFSLENBQVg7QUFDQSxJQUFJLE1BQU0sU0FBVjtBQUNBLElBQUksR0FBSixDQUFRLFdBQVcsVUFBWCxDQUFzQixFQUFFLFVBQVUsS0FBWixFQUF0QixDQUFSO0FBQ0EsSUFBSSxHQUFKLENBQVEsV0FBVyxJQUFYLEVBQVI7O0FBRUEsSUFBSSxHQUFKLENBQVEsaUJBQVI7O0FBRUEsSUFBSSxJQUFKLENBQVMsT0FBVCxFQUFrQixVQUFDLEdBQUQsRUFBTSxHQUFOLEVBQVcsSUFBWCxFQUFvQjtBQUNwQyxVQUFRLEdBQVIsQ0FBWSxJQUFJLElBQWhCLEU7QUFDQSxPQUFLLE9BQUwsQ0FBYSxJQUFJLElBQWpCLEVBQXVCLElBQUksSUFBSixDQUFTLEVBQWhDLEVBQ0csSUFESCxDQUNRLGVBQU87QUFDWCxRQUFJLE1BQUosQ0FBVyxHQUFYLEVBQWdCLElBQWhCLENBQXFCLEdBQXJCO0FBQ0QsR0FISDs7QUFLRCxDQVBEOztBQVNBLElBQUksR0FBSixDQUFRLFdBQVIsRUFBcUIsVUFBQyxHQUFELEVBQU0sR0FBTixFQUFXLElBQVgsRUFBb0I7QUFDdkMsTUFBSSxPQUFPO0FBQ1QsZUFBVyxhQURGO0FBRVQsY0FBVTtBQUZELEdBQVg7QUFJQSxNQUFJLElBQUosQ0FBUyxJQUFUO0FBQ0QsQ0FORDs7QUFRQSxJQUFJLEdBQUosQ0FBUSxVQUFDLEdBQUQsRUFBTSxHQUFOLEVBQVcsR0FBWCxFQUFnQixJQUFoQixFQUF5QjtBQUMvQixVQUFRLEdBQVIsQ0FBWSxLQUFaLEVBQW1CLElBQUksVUFBSixJQUFrQixHQUFyQztBQUNBLE1BQUksTUFBSixDQUFXLElBQUksVUFBSixJQUFrQixHQUE3QixFQUFrQyxJQUFsQztBQUNELENBSEQ7O0FBS0EsSUFBSSxNQUFKLENBQVcsUUFBUSxHQUFSLENBQVksSUFBWixJQUFvQixJQUEvQjs7QUFHQSxPQUFPLE9BQVAsR0FBaUIsR0FBakIiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gYXBwLmpzXG52YXIgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbnZhciBib2R5UGFyc2VyID0gcmVxdWlyZSgnYm9keS1wYXJzZXInKTtcbnZhciB0b2tlbk1pZGRsZXdhcmUgPSByZXF1aXJlKCcuL3Rva2VuJyk7XG5cbnZhciBtb29kID0gcmVxdWlyZSgnLi9tb29kJyk7XG52YXIgYXBwID0gZXhwcmVzcygpO1xuYXBwLnVzZShib2R5UGFyc2VyLnVybGVuY29kZWQoeyBleHRlbmRlZDogZmFsc2UgfSkpO1xuYXBwLnVzZShib2R5UGFyc2VyLmpzb24oKSk7XG5cbmFwcC51c2UodG9rZW5NaWRkbGV3YXJlKCkpO1xuXG5hcHAucG9zdCgnL21vb2QnLCAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgY29uc29sZS5sb2cocmVxLnVzZXIpIC8vIHNvbmdJZFxuICBtb29kLmhhbmRsZXIocmVxLmJvZHksIHJlcS51c2VyLmlkKVxuICAgIC50aGVuKGFucyA9PiB7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChhbnMpO1xuICAgIH0pXG4gIC8vIG5leHRcbn0pXG5cbmFwcC5nZXQoJ3BhcnR5aW5mbycsIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB2YXIgaW5mbyA9IHtcbiAgICBzdGFydFRpbWU6IDE0NjMyNjM3MjMzMDAsXG4gICAgbG9jYXRpb246ICdDb29sIFBhcmsnXG4gIH1cbiAgcmVzLmpzb24oaW5mbyk7XG59KVxuXG5hcHAudXNlKChlcnIsIHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnNvbGUubG9nKCdlcnInLCBlcnIuc3RhdHVzQ29kZSB8fCBlcnIpXG4gIHJlcy5zdGF0dXMoZXJyLnN0YXR1c0NvZGUgfHwgZXJyKS5zZW5kKCk7XG59KVxuXG5hcHAubGlzdGVuKHByb2Nlc3MuZW52LlBPUlQgfHwgOTAwMClcblxuXG5tb2R1bGUuZXhwb3J0cyA9IGFwcDtcbiJdfQ==